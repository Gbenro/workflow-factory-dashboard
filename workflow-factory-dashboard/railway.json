{
  "$schema": "https://railway.app/railway.schema.json",
  "build": {
    "builder": "dockerfile"
  },
  "services": {
    "postgres": {
      "image": "postgres:15-alpine",
      "environment": {
        "POSTGRES_USER": "workflow_user",
        "POSTGRES_PASSWORD": "workflow_password_123",
        "POSTGRES_DB": "workflow_db"
      },
      "volumes": {
        "postgres_data": "/var/lib/postgresql/data"
      },
      "port": 5432
    },
    "backend": {
      "build": {
        "context": "./backend",
        "dockerfile": "Dockerfile"
      },
      "port": 8000,
      "environment": {
        "DATABASE_URL": "postgresql://workflow_user:workflow_password_123@postgres:5432/workflow_db",
        "PYTHONUNBUFFERED": "1",
        "ENV": "production",
        "SECRET_KEY": "your-secret-key-here-change-in-production",
        "CORS_ORIGINS": "*"
      },
      "depends_on": [
        "postgres"
      ]
    },
    "frontend": {
      "build": {
        "context": "./frontend",
        "dockerfile": "Dockerfile"
      },
      "port": 3000,
      "environment": {
        "NEXT_PUBLIC_API_URL": "http://localhost:8000",
        "NEXT_PUBLIC_WS_URL": "ws://localhost:8000",
        "NODE_ENV": "production"
      },
      "depends_on": [
        "backend"
      ]
    }
  },
  "volumes": {
    "postgres_data": {}
  }
}